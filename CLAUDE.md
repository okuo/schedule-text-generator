# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## プロジェクト概要

このプロジェクトはVanilla JavaScriptベースのスケジュールテキスト生成ツールです。外部フレームワークに依存せず、純粋なHTML、CSS、JavaScriptで実装されています。

## コマンド

### 開発環境
- **ローカルサーバー起動**: `python -m http.server 8000` または `npx serve .`
- **ファイル監視**: Live Server拡張機能を使用するかブラウザで直接HTMLファイルを開く

### テスト
- **単体テスト**: テストフレームワークが設定されている場合、通常のJavaScriptテスト実行
- **ブラウザテスト**: 開発者ツールのコンソールでテスト

## アーキテクチャ

### ディレクトリ構造
典型的な構造:
```
/
├── index.html          # メインエントリーポイント
├── css/               # スタイルシート
│   └── style.css
├── js/                # JavaScriptモジュール
│   ├── main.js        # メインロジック
│   ├── scheduler.js   # スケジュール処理
│   └── textGenerator.js # テキスト生成
└── assets/            # 静的リソース
```

### 設計パターン
- **モジュールパターン**: 機能ごとにJSファイルを分離
- **イベント駆動**: DOM操作とユーザーインタラクション
- **関数型アプローチ**: 純粋関数でのデータ変換

### 主要コンポーネント
- **Scheduler**: スケジュールデータの管理と操作
- **TextGenerator**: スケジュールからテキスト形式への変換
- **UI Controller**: DOM操作とユーザーイベント処理

### データフロー
1. ユーザー入力 → スケジュールデータ構造
2. スケジュールデータ → テキスト生成処理
3. 生成されたテキスト → UI表示/エクスポート

## 開発時の注意点

### 基本ルール
- ES6+モジュール構文を使用する場合は `type="module"` を指定
- ブラウザ互換性を考慮したJavaScript記述
- CORSエラー対策のためローカルサーバーを使用
- デバッグにはブラウザの開発者ツールを活用

### 実装の重要な制約
- **ドラッグ選択の整合性**: `updateSelectionDisplay`と`markSelectedCells`の条件は一致させること
- **時間計算の統一**: シングルクリック（15分）とドラッグ選択で適切に時間範囲を計算
- **マウスイベントの処理**: ドラッグ中の状態管理と表示更新を同期

### UI/UXの考慮事項
- **フォント**: Windows 11の`Segoe UI Variable Display`を優先使用
- **色の統一性**: 選択中（`#34d399`）と確定後（`#34d399`）の色を統一
- **レスポンシブ**: 画面サイズに応じた適切な表示

## 最新の実装状況

### v1.2の主要機能
- **リアルタイム時間表示**: `showDragTimeDisplay()`でドラッグ中に時間範囲表示
- **選択精度の改善**: シングルクリックとドラッグ選択の正確な区別
- **UI最適化**: ヘッダースペース削減、フォントサイズ調整

### 既知の制約・課題
- 祝日データがハードコーディング（今後外部API化検討）
- 同日内選択のみ対応（複数日選択非対応）
- 9:00-18:00の固定時間範囲